<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Get a professional resume review with ATS optimization and recruiter feedback. Choose from Basic or Advanced plans at ResumeDecoded.">
  <meta name="keywords" content="resume review, ATS check, career services, job prep, resume optimization">
  <meta name="author" content="ResumeDecoded">
  <title>Resume Review | ResumeDecoded</title>
  <link rel="stylesheet" href="styles.css">
  <!-- Preload critical resources for performance -->
  <link rel="preload" href="styles.css" as="style">
  <!-- Structured data for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Service",
    "name": "Professional Resume Review",
    "provider": {
      "@type": "Organization",
      "name": "ResumeDecoded"
    },
    "description": "ATS-optimized resume reviews with recruiter logic and clear feedback.",
    "offers": [
      {
        "@type": "Offer",
        "name": "Basic Review",
        "price": "999",
        "priceCurrency": "INR"
      },
      {
        "@type": "Offer",
        "name": "Advanced Review",
        "price": "1999",
        "priceCurrency": "INR"
      }
    ]
  }
  </script>
  <!-- Razorpay Checkout Script (added for payment integration) -->
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
  <!-- Header with navigation -->
  <header class="navbar" role="banner">
    <div class="container nav-flex">
      <h1 class="logo">ResumeDecoded</h1>
    </div>
  </header>

  <!-- Main content -->
  <main class="section" role="main">
    <div class="container">
      <h2>Professional Resume Review</h2>
      <p>ATS + recruiter logic. Clear feedback. No false promises.</p>

      <!-- Pricing section -->
      <section class="pricing" aria-labelledby="pricing-heading">
        <h3 id="pricing-heading" class="sr-only">Pricing Options</h3>
        <div class="grid pricing">
          <article class="card" data-plan="basic" data-amount="99900"> <!-- Added data-amount for JS (in paisa) -->
            <h4>Basic Review</h4>
            <p class="price">₹999</p>
            <ul>
              <li>ATS compatibility check</li>
              <li>Role alignment feedback</li>
              <li>Written improvement notes</li>
            </ul>
            <button class="btn primary select-btn" type="button" aria-describedby="basic-desc">Select</button>
            <div id="basic-desc" class="sr-only">Selects the Basic Review plan for ATS check and feedback.</div>
          </article>

          <article class="card highlight" data-plan="advanced" data-amount="199900"> <!-- Added data-amount for JS (in paisa) -->
            <h4>Advanced Review</h4>
            <p class="price">₹1999</p>
            <ul>
              <li>ATS optimization</li>
              <li>Bullet rewrite suggestions</li>
              <li>Recruiter evaluation logic</li>
              <li>Interview readiness score</li>
            </ul>
            <button class="btn primary select-btn" type="button" aria-describedby="advanced-desc">Select</button>
            <div id="advanced-desc" class="sr-only">Selects the Advanced Review plan for full optimization and scoring.</div>
          </article>
        </div>
      </section>

      <!-- Form section -->
      <section aria-labelledby="form-heading">
        <form class="form" id="resume-form" action="#" method="post" enctype="multipart/form-data" novalidate>
          <h3 id="form-heading">Submit Your Resume</h3>

          <fieldset>
            <legend class="sr-only">Personal Information</legend>
            <div class="form-group">
              <label for="full-name">Full Name</label>
              <input type="text" id="full-name" name="full-name" placeholder="Your name" required aria-describedby="name-error">
              <span id="name-error" class="error" aria-live="polite"></span>
            </div>

            <div class="form-group">
              <label for="email">Email</label>
              <input type="email" id="email" name="email" placeholder="your@email.com" required aria-describedby="email-error">
              <span id="email-error" class="error" aria-live="polite"></span>
            </div>

            <div class="form-group">
              <label for="target-role">Target Role</label>
              <select id="target-role" name="target-role" required>
                <option value="">Select a role</option>
                <option value="data-analyst">Data Analyst</option>
                <option value="software-engineer">Software Engineer</option>
                <option value="business-analyst">Business Analyst</option>
                <option value="other">Other</option>
              </select>
            </div>

            <div class="form-group">
              <label for="resume-file">Resume (PDF only)</label>
              <input type="file" id="resume-file" name="resume-file" accept=".pdf" required aria-describedby="file-error">
              <span id="file-error" class="error" aria-live="polite"></span>
            </div>
          </fieldset>

          <!-- Payment placeholder -->
          <div class="payment-box" role="region" aria-labelledby="payment-heading">
            <h4 id="payment-heading">Payment Step</h4>
            <p>Razorpay integration active</p> <!-- Updated text -->
          </div>

          <button class="btn primary" id="proceed-btn" type="submit">Proceed to Payment</button>
        </form>
      </section>
    </div>
  </main>

  <!-- JavaScript for functionality -->
  <script>
    let selectedPlan = null;
    let selectedAmount = null;

    // Function to handle plan selection
    function selectPlan(plan, amount) {
      document.querySelectorAll('.card').forEach(card => card.classList.remove('selected'));
      document.querySelector(`[data-plan="${plan}"]`).classList.add('selected');
      selectedPlan = plan;
      selectedAmount = amount;
      document.querySelector(`[data-plan="${plan}"] .select-btn`).textContent = 'Selected';
    }

    // Add event listeners to Select buttons
    document.querySelectorAll('.select-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const card = e.target.closest('.card');
        const plan = card.dataset.plan;
        const amount = card.dataset.amount;
        selectPlan(plan, amount);
      });
    });

    // Handle form submission (Proceed to Payment)
    document.getElementById('proceed-btn').addEventListener('click', async (e) => {
      e.preventDefault();
      if (!selectedPlan) {
        alert('Please select a plan.');
        return;
      }
      const form = document.getElementById('resume-form');
      if (!form.checkValidity()) {
        alert('Please fill in all required fields.');
        return;
      }

      // Create order via backend
      try {
        const response = await fetch('http://localhost:3000/create-order', { // Update to your deployed backend URL
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ amount: selectedAmount, plan: selectedPlan }),
        });
        const order = await response.json();

        // Open Razorpay Checkout
        const options = {
          key: 'YOUR_RAZORPAY_KEY_ID', // Replace with your Key ID
          amount: order.amount,
          currency: order.currency,
          name: 'ResumeDecoded',
          description: `${selectedPlan} Review`,
          order_id: order.id,
          handler: function (response) {
            alert('Payment successful! Payment ID: ' + response.razorpay_payment_id);
            // Send to backend for verification: fetch('/verify-payment', { method: 'POST', body: JSON.stringify(response) });
            // Then, process the form data (e.g., send email or save to DB)
          },
          prefill: {
            name: document.getElementById('full-name').value,
            email: document.getElementById('email').value,
          },
          theme: { color: '#111' },
        };
        const rzp = new Razorpay(options);
        rzp.open();
      } catch (error) {
        alert('Error creating order: ' + error.message);
      }
    });
  </script>
</body>
</html>
